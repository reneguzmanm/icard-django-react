{"ast":null,"code":"var _jsxFileName = \"C:\\\\Cursos\\\\Full\\\\icard\\\\icard_react\\\\icard\\\\src\\\\pages\\\\Admin\\\\TableDetailsAdmin.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { Loader } from 'semantic-ui-react';\nimport { useParams } from 'react-router-dom';\nimport { forEach, size } from 'lodash';\nimport { ListOrderAdmin } from '../../components/Admin/TableDetails';\nimport { HeaderPage } from \"../../components/Admin\";\nimport { ModalBasic } from \"../../components/Common\";\nimport { useOrder, useTable, usePayment } from '../../hooks';\nimport { number } from 'yup';\nimport { AddOrderForm } from '../../components/Admin';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport function TableDetailsAdmin() {\n  _s();\n\n  const [reloadOrders, setReloadOrders] = useState(false);\n  const [paymentData, setPaymentData] = useState(null);\n  const {\n    id\n  } = useParams();\n  const {\n    loading,\n    orders,\n    getOrdersByTable,\n    addPaymentToOrder\n  } = useOrder();\n  const {\n    table,\n    getTable\n  } = useTable();\n  const {\n    createPayment,\n    getPaymentByTable\n  } = usePayment();\n  const [showModal, setShowModal] = useState(false);\n  useEffect(() => {\n    getOrdersByTable(id, \"\", \"ordering=-status,created_at\");\n  }, [id, reloadOrders]);\n  useEffect(() => getTable(id), [id]);\n  useEffect(() => {\n    (async () => {\n      const response = await getPaymentByTable(id);\n      console.log(respose);\n      if (size(response) > 0) console.log(\"Cuenta pedida\");else console.log(\"Cuenta no pedida\");\n    })();\n  }, [reloadOrders]);\n\n  const onReloadOrders = () => setReloadOrders(prev => !prev);\n\n  const openCloseModal = () => setShowModal(prev => !prev);\n\n  const onCreatePayment = async () => {\n    const result = window.confirm('Estas seguro de generar la cuenta de la mesa?');\n\n    if (result) {\n      let totalPayment = 0;\n      forEach(orders, order => {\n        totalPayment += Number(order.product_data.price);\n      });\n      const resultTypePayment = window.confirm('Â¿Quieres pago con tajeta pulsa ACEPTAR, con efectivo CANCELAR?');\n      const paymentData = {\n        table: id,\n        totalPayment: totalPayment.toFixed(2),\n        paymentType: resultTypePayment ? \"CARD\" : \"CASH\",\n        statusPayment: \"PENDING\"\n      };\n      const payment = await createPayment(paymentData);\n\n      for await (const order of orders) {\n        await addPaymentToOrder(order.id, payment.id);\n      }\n\n      onReloadOrders();\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(HeaderPage, {\n      title: `Mesa ${table === null || table === void 0 ? void 0 : table.number}`,\n      btnTitle: \"A\\xF1adir pedido\",\n      btnClick: openCloseModal,\n      btnTitleTwo: \"Generar cuenta\",\n      btnClickTwo: onCreatePayment\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this), loading ? /*#__PURE__*/_jsxDEV(Loader, {\n      active: true,\n      inline: \"centered\",\n      children: \"Cargando ...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(ListOrderAdmin, {\n      orders: orders,\n      onReloadOrders: onReloadOrders\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(ModalBasic, {\n      show: showModal,\n      onClose: openCloseModal,\n      title: \"Generar pedido\",\n      children: /*#__PURE__*/_jsxDEV(AddOrderForm, {\n        idTable: id,\n        openCloseModal: openCloseModal,\n        onReloadOrders: onReloadOrders\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n}\n\n_s(TableDetailsAdmin, \"z14qL9EfsJSrIjCfMjrMNlPKTE8=\", false, function () {\n  return [useParams, useOrder, useTable, usePayment];\n});\n\n_c = TableDetailsAdmin;\n\nvar _c;\n\n$RefreshReg$(_c, \"TableDetailsAdmin\");","map":{"version":3,"sources":["C:/Cursos/Full/icard/icard_react/icard/src/pages/Admin/TableDetailsAdmin.js"],"names":["React","useEffect","useState","Loader","useParams","forEach","size","ListOrderAdmin","HeaderPage","ModalBasic","useOrder","useTable","usePayment","number","AddOrderForm","TableDetailsAdmin","reloadOrders","setReloadOrders","paymentData","setPaymentData","id","loading","orders","getOrdersByTable","addPaymentToOrder","table","getTable","createPayment","getPaymentByTable","showModal","setShowModal","response","console","log","respose","onReloadOrders","prev","openCloseModal","onCreatePayment","result","window","confirm","totalPayment","order","Number","product_data","price","resultTypePayment","toFixed","paymentType","statusPayment","payment"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { Loader } from 'semantic-ui-react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { forEach, size } from 'lodash';\r\nimport { ListOrderAdmin } from '../../components/Admin/TableDetails';\r\nimport { HeaderPage } from \"../../components/Admin\";\r\nimport { ModalBasic } from \"../../components/Common\";\r\nimport { useOrder, useTable, usePayment } from '../../hooks';\r\nimport { number } from 'yup';\r\nimport { AddOrderForm } from '../../components/Admin';\r\n\r\nexport function TableDetailsAdmin() {\r\n  const [reloadOrders, setReloadOrders] = useState(false);\r\n  const [paymentData, setPaymentData] = useState(null);\r\n  const { id } = useParams();\r\n  const {loading, orders, getOrdersByTable, addPaymentToOrder } = useOrder();\r\n  const { table, getTable } = useTable();\r\n  const { createPayment, getPaymentByTable } = usePayment();\r\n \r\n  const [showModal, setShowModal] = useState(false);\r\n\r\n  useEffect(() => {\r\n    getOrdersByTable(id, \"\", \"ordering=-status,created_at\")\r\n  }, [id, reloadOrders]);\r\n  \r\n  useEffect(() => getTable(id), [id]);\r\n\r\n  useEffect(() => {\r\n    (async () =>{\r\n      const response = await getPaymentByTable(id);\r\n      console.log(respose);\r\n      if(size(response) > 0) console.log(\"Cuenta pedida\");\r\n      else console.log(\"Cuenta no pedida\");\r\n    })()\r\n  }, [reloadOrders])\r\n  \r\n  \r\n  const onReloadOrders = () => setReloadOrders((prev) => !prev);\r\n  const openCloseModal = () => setShowModal((prev) => !prev);\r\n\r\n  const onCreatePayment = async () => {\r\n    const result = window.confirm('Estas seguro de generar la cuenta de la mesa?');\r\n    if(result){\r\n      let totalPayment = 0;\r\n      forEach(orders, (order) =>{\r\n        totalPayment += Number(order.product_data.price);\r\n      })\r\n\r\n    const resultTypePayment = window.confirm('Â¿Quieres pago con tajeta pulsa ACEPTAR, con efectivo CANCELAR?');\r\n\r\n      const paymentData = {\r\n        table: id,\r\n        totalPayment: totalPayment.toFixed(2),\r\n        paymentType: resultTypePayment ? \"CARD\" : \"CASH\",\r\n        statusPayment: \"PENDING\",\r\n      };\r\n\r\n      const payment = await createPayment(paymentData);\r\n\r\n      for await (const order of orders){\r\n        await addPaymentToOrder(order.id, payment.id)\r\n      }\r\n      onReloadOrders();\r\n    }\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <HeaderPage \r\n        title={`Mesa ${table?.number}`} \r\n        btnTitle=\"AÃ±adir pedido\" \r\n        btnClick={openCloseModal}\r\n        btnTitleTwo=\"Generar cuenta\"\r\n        btnClickTwo={onCreatePayment}\r\n      />\r\n      {loading ? (\r\n        <Loader active inline=\"centered\">\r\n          Cargando ...\r\n        </Loader>\r\n      ):(\r\n        <ListOrderAdmin orders={orders} onReloadOrders={onReloadOrders} />\r\n      )}\r\n\r\n      <ModalBasic show={showModal} onClose={openCloseModal} title=\"Generar pedido\">\r\n        <AddOrderForm idTable={id} openCloseModal={openCloseModal} onReloadOrders={onReloadOrders}/>\r\n      </ModalBasic>\r\n    </>\r\n  )\r\n}"]},"metadata":{},"sourceType":"module"}